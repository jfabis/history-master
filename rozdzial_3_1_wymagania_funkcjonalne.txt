3.1. Wymagania funkcjonalne systemu

Wymagania funkcjonalne definiują konkretne zachowania oraz funkcje, które system musi realizować, aby spełnić potrzeby użytkowników końcowych. W przypadku platformy HistoryMaster wymagania te zostały zorganizowane w grupy tematyczne odpowiadające głównym obszarom funkcjonalnym aplikacji. Pierwsza grupa wymagań dotyczy zarządzania użytkownikami oraz autentykacji. System musi umożliwiać rejestrację nowych użytkowników poprzez formularz wymagający podania adresu email oraz hasła, które następnie jest zabezpieczane algorytmem bcrypt przed zapisem w bazie danych. Alternatywnie użytkownicy mogą korzystać z mechanizmu OAuth 2.0 do logowania poprzez konta Google, co upraszcza proces rejestracji oraz eliminuje konieczność zapamiętywania dodatkowych haseł.

Po pomyślnej autentykacji system generuje parę tokenów JWT: access token o krótkim czasie życia (15 minut), który jest wykorzystywany do autoryzacji żądań API, oraz refresh token o dłuższym okresie ważności (7 dni), przechowywany bezpiecznie w bazie danych. Mechanizm ten umożliwia użytkownikom utrzymanie sesji bez konieczności częstego ponownego logowania, jednocześnie minimalizując ryzyko związane z potencjalnym przejęciem tokena dostępowego. System musi również wspierać funkcjonalność wylogowania, która rewokuje refresh token poprzez ustawienie flagi revoked w bazie danych, uniemożliwiając dalsze korzystanie z sesji.

Druga grupa wymagań funkcjonalnych obejmuje moduł Księga Wiedzy realizujący funkcjonalność cyfrowych fiszek edukacyjnych. System musi prezentować użytkownikowi karty zawierające kluczowe informacje historyczne, umożliwiając ich przeglądanie w sposób sekwencyjny przy użyciu przycisków nawigacyjnych. Każda fiszka składa się z pytania lub terminu na przedniej stronie oraz odpowiedzi lub definicji na stronie tylnej. Użytkownik musi mieć możliwość przewrócenia karty poprzez kliknięcie, co symuluje fizyczne fiszki papierowe. Interfejs powinien zapewniać płynną animację 3D podczas zmiany stron karty z wykorzystaniem CSS transitions oraz transform-style: preserve-3d.

Fiszki muszą być zorganizowane w tematyczne zestawy odpowiadające okresom historycznym, takim jak Starożytność czy Średniowiecze. Każda karta posiada typ (FACT, DATE, FIGURE, TERM, EVENT), który determinuje kategorię pytania wyświetlaną w interfejsie. System monitoruje czas spędzony w trybie nauki poprzez aktualizację pola lastActive w tabeli UserProgress, co wpływa na obliczanie passy dziennej (currentStreak). Użytkownik może w dowolnym momencie wrócić do wyboru tematu bez utraty postępu w bieżącej sesji.

Trzecia grupa wymagań dotyczy modułu Wielki Test, który realizuje funkcjonalność quizów historycznych. System musi generować pytania wielokrotnego wyboru na podstawie bazy danych zawierającej pytania, odpowiedź prawidłową oraz tablicę opcji odpowiedzi (pole options typu String[]). Każde pytanie posiada poziom trudności (difficulty) wyrażony numerycznie oraz przypisanie do tematu. Po wybraniu odpowiedzi przez użytkownika system musi natychmiast zwalidować jej poprawność oraz wyświetlić feedback zawierający informację o prawidłowej odpowiedzi (podświetlonej na zielono), a w przypadku błędu dodatkowo niepoprawny wybór jest oznaczony na czerwono. Szczegółowe wyjaśnienie wraz z kontekstem historycznym (pole explanation) jest prezentowane niezależnie od poprawności odpowiedzi.

System musi śledzić historię odpowiedzi użytkownika w tabeli UserAnswer, rejestrując identyfikator użytkownika, identyfikator pytania, flagę poprawności (isCorrect) oraz datę udzielenia odpowiedzi. Na podstawie tych danych algorytm adaptacyjny powinien dynamicznie dostosowywać poziom trudności kolejnych pytań. Jeśli użytkownik konsekwentnie udziela poprawnych odpowiedzi, system zwiększa trudność. Odwrotnie, w przypadku serii błędnych odpowiedzi system obniża poziom trudności. Po zakończeniu quizu system oblicza liczbę poprawnych odpowiedzi oraz przyznaje punkty doświadczenia (XP), a następnie aktualizuje pole xp w tabeli UserProgress.

Czwarta grupa wymagań funkcjonalnych obejmuje moduł Oś Czasu prezentujący interaktywną wizualizację wydarzeń historycznych. System musi renderować wydarzenia na horyzontalnej osi czasu, gdzie każde wydarzenie jest reprezentowane przez okrągły marker. Wydarzenia są wyświetlane w porządku chronologicznym określonym przez pole sortOrder. Użytkownik nawiguje po osi poprzez horyzontalne scrollowanie (z obsługą Shift + Scroll). Interfejs wykorzystuje Framer Motion do implementacji efektu magnifying dock: po najechaniu kursorem na marker, ten dynamicznie powiększa się, a nad nim pojawia się dymek kontekstowy zawierający rok, tytuł, opis oraz epokę (era) wydarzenia.

System nie implementuje funkcjonalności powiększania całego widoku ani wyszukiwania tekstowego. Wydarzenia nie są filtrowane dynamicznie według kategorii. Wizualizacja polega na prostej chronologicznej linii z interaktywnymi markerami reagującymi na pozycję kursora myszy poprzez animacje skali oraz opacity. Efekt ten wykorzystuje useMotionValue oraz useTransform z biblioteki Framer Motion do obliczania odległości między kursorem a poszczególnymi markerami.

Piąta grupa wymagań dotyczy modułu Wizje AI, który wykorzystuje sztuczną inteligencję do generowania obrazów historycznych. System musi integrować się z Google Vertex AI oraz modelem Imagen 3.0 poprzez dedykowany adapter (ImageGeneratorAdapter), który enkapsuluje logikę komunikacji z zewnętrznym API. Adapter autentykuje się przy użyciu Google Cloud Service Account credentials oraz przesyła żądania POST do endpointu Vertex AI z promptem oraz parametrami generowania (aspectRatio: 16:9, number of images: 1, safety settings).

W pierwszym podtrybie, Detektyw Czasu, system losuje scenariusz z tabeli TimeDetectiveScenario, generuje obraz przedstawiający scenę historyczną, a następnie prezentuje użytkownikowi pytanie wielokrotnego wyboru dotyczące epoki. Użytkownik musi przeanalizować szczegóły obrazu aby poprawnie zidentyfikować okres. Poprawna odpowiedź jest nagradzana 50 punktami XP. W drugim podtrybie, Analiza Bitwy, system losuje bitwę z tabeli HistoricalBattle, generuje wizualizację oraz prezentuje pytanie o zwycięzcę starcia. Poprawna odpowiedź jest nagradzana 100 punktami XP. Trzeci podtryb, Stroje przez Wieki, koncentruje się na historii mody poprzez generowanie obrazów strojów z tabeli HistoricalCostume. Tryb ma charakter edukacyjny bez pytań, a użytkownik otrzymuje 30 punktów XP za przeglądnięcie stroju wraz z jego opisem.

System śledzi już wyświetlone scenariusze w localStorage pod kluczami timeDet_seen, battles_seen oraz costumes_seen, zapobiegając powtarzaniu tych samych obrazów. Po wyczerpaniu dostępnych opcji system automatycznie resetuje pulę. Wygenerowane obrazy są przechowywane w tabeli GeneratedAsset zawierającej prompt, nazwę dostawcy oraz URL obrazu. Podczas generowania, które może potrwać do 15 sekund, system wyświetla ekran ładowania z losową ciekawostką historyczną.

Szósta grupa wymagań funkcjonalnych dotyczy systemu progresji użytkowników. System musi przyznawać punkty doświadczenia (XP) za aktywność użytkownika w aplikacji, w tym za poprawne odpowiedzi w quizach oraz aktywność w trybach AI. Punkty doświadczenia akumulują się w polu xp tabeli UserProgress, prowadząc do awansów na kolejne poziomy zaawansowania (pole level). Formuła obliczająca wymagane punkty dla kolejnych poziomów jest progresywna, gdzie każdy kolejny poziom wymaga więcej punktów niż poprzedni. System oblicza aktualny poziom na podstawie wartości XP dynamicznie w interfejsie użytkownika.

System musi wizualizować postęp użytkownika poprzez pasek doświadczenia wyświetlany w panelu głównym oraz w profilu użytkownika, pokazujący aktualną ilość punktów oraz próg wymagany do osiągnięcia następnego poziomu. Dodatkowo system śledzi passę dni aktywności (currentStreak) oraz całkowitą liczbę aktywnych dni (totalActiveDays), które są wyświetlane w statystykach użytkownika. System oblicza również współczynnik poprawnych odpowiedzi (accuracy) na podstawie historii w tabeli UserAnswer. Mechanizm progresji ma na celu utrzymanie długoterminowej motywacji użytkowników poprzez dostarczanie regularnego poczucia osiągnięć oraz postępu.
